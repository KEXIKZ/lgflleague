<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KRP Launcher | L.G.F.L</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:wght@400&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0c0f14;
      --surface:#121622;
      --surface2:#171c2b;
      --surface3:#1c2233;
      --text:#e7e9f1;
      --outline:rgba(231,233,241,.10);
      --outline2:rgba(231,233,241,.18);
      --primary:#8ab4ff;
      --danger:#ff7a7a;
      --ok:#65d48e;
      --admin:#bb86fc;
      --news:#ffb86b;
      --message:#50fa7b;
      --bot:#ff79c6;
      --roblox:#ff4d4d;
      --krp-black:#2c2c2c;
      --krp-blue:#3a6ea5;
      --r-xl:22px;
      --r-lg:18px;
      --shadow:0 10px 30px rgba(0,0,0,.35);
    }
    
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes fadeInLeft {
      from { opacity: 0; transform: translateX(-30px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    @keyframes fadeInRight {
      from { opacity: 0; transform: translateX(30px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    @keyframes scaleIn {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
    
    @keyframes slideInDown {
      from { opacity: 0; transform: translateY(-100%); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes gradientFlow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.1); opacity: 0.8; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes shimmer {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }
    
    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }
    
    @keyframes glow {
      0% { box-shadow: 0 0 5px rgba(255,77,77,0.3); }
      50% { box-shadow: 0 0 30px rgba(255,77,77,0.8); }
      100% { box-shadow: 0 0 5px rgba(255,77,77,0.3); }
    }
    
    @keyframes loaderPulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.2); opacity: 0.7; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      letter-spacing:.2px;
      overflow-x: hidden;
    }

    .app{min-height:100%;display:flex;flex-direction:column}

    /* LOADER SCREEN */
    .loader-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg);
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }
    
    .loader-screen.fade-out {
      opacity: 0;
      visibility: hidden;
    }
    
    .loader-content {
      text-align: center;
      animation: scaleIn 0.6s ease-out;
    }
    
    .loader-logo {
      width: 100px;
      height: 100px;
      background: var(--surface2);
      border: 3px solid var(--roblox);
      border-radius: 30px;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0 auto 30px;
      animation: float 3s ease-in-out infinite, glow 2s ease-in-out infinite;
    }
    
    .loader-logo .material-symbols-rounded {
      font-size: 60px;
      color: var(--roblox);
      animation: pulse 2s ease-in-out infinite;
    }
    
    .loader-title {
      font-size: 32px;
      font-weight: 800;
      margin-bottom: 30px;
      background: linear-gradient(90deg, var(--roblox), var(--krp-blue), var(--krp-black));
      background-size: 300% auto;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: gradientFlow 3s linear infinite;
    }
    
    .loader-spinner {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin: 30px 0;
    }
    
    .loader-dot {
      width: 20px;
      height: 20px;
      background: var(--roblox);
      border-radius: 50%;
      animation: loaderPulse 1.5s ease-in-out infinite;
    }
    
    .loader-dot:nth-child(1) { animation-delay: 0s; }
    .loader-dot:nth-child(2) { animation-delay: 0.2s; }
    .loader-dot:nth-child(3) { animation-delay: 0.4s; }
    .loader-dot:nth-child(4) { animation-delay: 0.6s; }
    .loader-dot:nth-child(5) { animation-delay: 0.8s; }
    
    .loader-text {
      font-size: 16px;
      opacity: 0.8;
      margin-top: 20px;
      animation: pulse 2s ease-in-out infinite;
    }
    
    .loader-progress {
      width: 300px;
      height: 4px;
      background: var(--surface3);
      border-radius: 4px;
      margin: 30px auto 0;
      overflow: hidden;
    }
    
    .loader-progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--roblox), var(--krp-blue));
      animation: progress 2s ease-out forwards;
    }
    
    @keyframes progress {
      0% { width: 0%; }
      20% { width: 20%; }
      40% { width: 40%; }
      60% { width: 60%; }
      80% { width: 80%; }
      100% { width: 100%; }
    }
    
    .topbar{
      position:sticky;top:0;z-index:10;
      background:rgba(12,15,20,.86);
      backdrop-filter:blur(10px);
      border-bottom:1px solid var(--outline);
      animation: slideInDown 0.6s ease-out;
    }
    .topbar__inner{
      max-width:980px;margin:0 auto;padding:14px 16px;
      display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    .brand{
      display:flex;align-items:center;gap:10px;min-width:160px;
      animation: fadeInLeft 0.6s ease-out;
    }
    .logo{
      width:36px;height:36px;border-radius:12px;
      background:var(--surface2);
      border:1px solid var(--outline2);
      display:grid;place-items:center;
      box-shadow:var(--shadow);
      transition: transform 0.3s ease;
    }
    .logo:hover {
      transform: rotate(360deg);
    }
    .logo .material-symbols-rounded{
      font-variation-settings:"FILL" 1,"wght" 500,"GRAD" 0,"opsz" 24;
      color:var(--roblox);font-size:20px;line-height:1;
    }
    .brand__name{
      background: linear-gradient(90deg, var(--roblox), var(--krp-blue), var(--krp-black));
      background-size: 300% auto;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: gradientFlow 4s linear infinite;
      font-weight:800;letter-spacing:1px
    }

    .nav{
      display:flex;align-items:center;gap:8px;
      animation: fadeInRight 0.6s ease-out;
    }

    .content{
      max-width:980px;margin:0 auto;padding:16px;width:100%;
      display:grid;grid-template-columns:1fr 280px;gap:14px;
    }
    @media (max-width:880px){ .content{grid-template-columns:1fr} .rightcol{order:-1} }

    .card{
      background:var(--surface);
      border:1px solid var(--outline);
      border-radius:var(--r-xl);
      padding:24px;
      box-shadow:var(--shadow);
      animation: fadeInUp 0.6s ease-out;
      transition: all 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 36px rgba(0, 0, 0, 0.4);
      border-color: var(--primary);
    }
    
    .card__title{
      display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:24px;
    }
    .card__title h2{font-size:20px;margin:0;font-weight:800;letter-spacing:.4px}

    .row{display:flex;gap:10px;align-items:center}
    .col{display:flex;flex-direction:column;gap:10px}

    .btn{
      appearance:none;
      border:1px solid var(--outline2);
      background:var(--surface3);
      color:var(--text);
      border-radius:999px;
      padding:10px 20px;
      cursor:pointer;
      font-weight:750;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display:inline-flex;align-items:center;gap:8px;
      user-select:none;white-space:nowrap;
    }
    .btn:hover{
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
      border-color:var(--primary);
    }
    .btn:active{transform:translateY(1px)}
    .btn:disabled{opacity:.55;cursor:not-allowed}

    .btn--primary{background:rgba(138,180,255,.16);border-color:rgba(138,180,255,.35)}
    .btn--roblox{background:rgba(255,77,77,.16);border-color:rgba(255,77,77,.35); color: #ff8a8a;}
    .btn--game{background:rgba(80,250,123,.16);border-color:rgba(80,250,123,.35)}
    .btn--black{background:rgba(44,44,44,.8);border-color:#4a4a4a; color:#ffffff;}
    .btn--blue{background:rgba(58,110,165,.8);border-color:#4d8cd4; color:#ffffff;}
    .btn--news{background:rgba(255,184,107,.16);border-color:rgba(255,184,107,.35); color:#ffb86b;}
    .btn--disabled{opacity:0.5;cursor:not-allowed;pointer-events:none;}

    .icon{
      font-family:"Material Symbols Rounded";
      font-weight:normal;font-style:normal;font-size:18px;line-height:1;
      letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;
      -webkit-font-feature-settings:'liga';-webkit-font-smoothing:antialiased;
    }

    .input, .textarea{
      width:100%;
      background:var(--surface3);
      border:1px solid var(--outline);
      color:var(--text);
      border-radius:var(--r-lg);
      padding:14px 16px;
      outline:none;
      transition: all 0.2s ease;
    }
    .textarea{
      min-height:100px;
      resize:vertical;
      font-family:inherit;
    }
    .input:focus, .textarea:focus{
      border-color:rgba(255,77,77,.5);
      box-shadow:0 0 0 3px rgba(255,77,77,.15);
      transform: scale(1.02);
    }
    .label{font-size:12px;opacity:.9;margin-bottom:6px}

    .hr{height:1px;background:var(--outline);margin:16px 0}
    .hidden{display:none !important}

    .toast{
      position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
      background:rgba(18,22,34,.92);
      border:1px solid var(--outline2);
      border-radius:999px;
      padding:10px 14px;
      display:none;align-items:center;gap:10px;
      box-shadow:var(--shadow);
      max-width:min(92vw,760px);
      z-index:50;
      animation: fadeInUp 0.3s ease-out;
    }
    .toast.show{display:flex}

    .game-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin: 16px 0;
    }
    
    .game-card {
      background: var(--surface2);
      border: 2px solid var(--outline);
      border-radius: var(--r-xl);
      padding: 20px 16px;
      text-align: center;
      transition: all 0.3s ease;
      animation: fadeInUp 0.6s ease-out;
    }
    
    .game-card[data-game="1"] {
      cursor: not-allowed;
      opacity: 0.6;
      position: relative;
      overflow: hidden;
    }
    
    .game-card[data-game="1"]::before {
      content: "‚õî –í–†–ï–ú–ï–ù–ù–û –ù–ï–î–û–°–¢–£–ü–ù–û";
      position: absolute;
      top: 10px;
      left: 0;
      right: 0;
      background: var(--danger);
      color: white;
      font-size: 12px;
      font-weight: bold;
      padding: 4px;
      transform: rotate(-5deg);
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }
    
    .game-card[data-game="1"]:hover {
      transform: none;
      border-color: var(--outline);
      box-shadow: none;
    }
    
    .game-card[data-game="2"] {
      cursor: pointer;
    }
    
    .game-card[data-game="2"]:hover {
      transform: translateY(-5px) scale(1.02);
      border-color: #3a6ea5;
      box-shadow: 0 10px 30px rgba(58,110,165,.5);
    }
    
    .game-card.selected[data-game="2"] {
      border-color: #3a6ea5;
      background: rgba(58,110,165,.3);
    }
    
    .game-icon {
      font-size: 48px;
      margin-bottom: 12px;
    }
    
    .game-title {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 8px;
    }
    
    .game-desc {
      font-size: 12px;
      opacity: 0.7;
    }
    
    .maintenance-badge {
      display: inline-block;
      background: var(--danger);
      color: white;
      font-size: 10px;
      font-weight: bold;
      padding: 2px 8px;
      border-radius: 999px;
      margin-top: 8px;
    }
    
    .launch-section {
      background: var(--surface2);
      border-radius: var(--r-lg);
      padding: 16px;
      margin: 16px 0;
      border: 1px solid var(--outline);
    }
    
    .krp-badge {
      background: rgba(58,110,165,.15);
      border: 1px solid rgba(58,110,165,.3);
      color: #8ab4ff;
      padding: 6px 12px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    
    .news-badge {
      background: rgba(255,184,107,.15);
      border: 1px solid rgba(255,184,107,.3);
      color: #ffb86b;
      padding: 6px 12px;
      border-radius: 999px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    
    .avatar-preview {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      overflow: hidden;
      border: 3px solid var(--roblox);
      transition: transform 0.3s ease;
    }
    
    .avatar-preview:hover {
      transform: scale(1.1) rotate(5deg);
    }
    
    .avatar-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .avatar-preview .placeholder {
      width: 100%;
      height: 100%;
      background: var(--surface3);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: bold;
      color: var(--roblox);
    }
    
    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-radius: 999px;
      background: var(--surface2);
      border: 1px solid var(--outline);
    }
    
    .status-online {
      color: var(--message);
    }
    
    .status-offline {
      color: var(--danger);
    }
    
    .badge {
      display:inline-flex;align-items:center;gap:6px;
      padding:4px 9px;border-radius:999px;
      font-size:12px;border:1px solid var(--outline2);
      background:rgba(255,255,255,.04);
      transition: all 0.2s ease;
    }
    
    .badge:hover {
      transform: scale(1.05);
    }
    
    .badge--roblox {
      border-color:rgba(255,77,77,.35);
      background:rgba(255,77,77,.10);
      color:#ff8a8a;
    }
    
    .badge--black {
      border-color:#2c2c2c;
      background:rgba(44,44,44,.3);
      color:#ffffff;
    }
    
    .badge--blue {
      border-color:#3a6ea5;
      background:rgba(58,110,165,.3);
      color:#8ab4ff;
    }
    
    .badge--news {
      border-color:#ffb86b;
      background:rgba(255,184,107,.3);
      color:#ffb86b;
    }
    
    .badge--maintenance {
      border-color:var(--danger);
      background:rgba(255,122,122,.2);
      color:var(--danger);
    }
    
    .news-feed {
      display: flex;
      flex-direction: column;
      gap: 12px;
      max-height: 400px;
      overflow-y: auto;
      padding-right: 4px;
    }
    
    .news-item {
      background: var(--surface2);
      border: 1px solid var(--outline);
      border-radius: var(--r-lg);
      padding: 12px;
      transition: all 0.2s ease;
      animation: fadeInRight 0.5s ease-out;
    }
    
    .news-item:hover {
      transform: translateX(4px);
      border-color: var(--news);
    }
    
    .news-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }
    
    .news-author {
      font-weight: bold;
      color: var(--news);
    }
    
    .news-time {
      font-size: 11px;
      opacity: 0.6;
    }
    
    .news-content {
      font-size: 13px;
      line-height: 1.5;
      white-space: pre-wrap;
    }
    
    .news-form {
      background: var(--surface2);
      border-radius: var(--r-lg);
      padding: 16px;
      margin-bottom: 16px;
      border: 1px solid var(--news);
    }
    
    .delete-news {
      opacity: 0.5;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-left: auto;
    }
    
    .delete-news:hover {
      opacity: 1;
      color: var(--danger);
      transform: scale(1.2);
    }

    .auth-switch {
      text-align: center;
      margin-top: 20px;
      opacity: 0.8;
      font-size: 14px;
    }
    
    .auth-switch span {
      color: var(--primary);
      cursor: pointer;
      text-decoration: underline;
    }
    
    .auth-switch span:hover {
      color: var(--message);
    }
  </style>
</head>

<body>
  <!-- LOADER SCREEN -->
  <div id="loaderScreen" class="loader-screen">
    <div class="loader-content">
      <div class="loader-logo">
        <span class="material-symbols-rounded">sports_esports</span>
      </div>
      <div class="loader-title">KRP LAUNCHER</div>
      <div class="loader-spinner">
        <div class="loader-dot"></div>
        <div class="loader-dot"></div>
        <div class="loader-dot"></div>
        <div class="loader-dot"></div>
        <div class="loader-dot"></div>
      </div>
      <div class="loader-text">–ó–∞–≥—Ä—É–∑–∫–∞ –ª–∞—É–Ω—á–µ—Ä–∞...</div>
      <div class="loader-progress">
        <div class="loader-progress-bar"></div>
      </div>
    </div>
  </div>

  <div class="app">
    <header class="topbar">
      <div class="topbar__inner">
        <div class="brand">
          <div class="logo" title="KRP Launcher"><span class="material-symbols-rounded">sports_esports</span></div>
          <div class="brand__name">KRP LAUNCHER</div>
        </div>

        <nav class="nav">
          <button id="navLauncher" class="btn btn--ghost"><span class="icon">videogame_asset</span> –õ–∞—É–Ω—á–µ—Ä</button>
          <button id="navNews" class="btn btn--ghost"><span class="icon">newspaper</span> –ù–æ–≤–æ—Å—Ç–∏</button>
          <button id="navProfile" class="btn btn--ghost hidden"><span class="icon">account_circle</span> –ü—Ä–æ—Ñ–∏–ª—å</button>
          <button id="btnLogout" class="btn btn--danger hidden"><span class="icon">logout</span> –í—ã–π—Ç–∏</button>
        </nav>
      </div>
    </header>

    <main class="content">
      <section class="leftcol">
        <!-- LOGIN CARD (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
        <div id="loginCard" class="card">
          <div class="card__title">
            <h2><span class="icon" style="color:var(--roblox);">login</span> –í—Ö–æ–¥ –≤ –ª–∞—É–Ω—á–µ—Ä</h2>
            <span class="krp-badge"><span class="icon">stadia_controller</span> KRP</span>
          </div>

          <div class="col" style="gap:16px;">
            <div>
              <div class="label">–ò–≥—Ä–æ–≤–æ–π –Ω–∏–∫</div>
              <input id="loginUsername" class="input" placeholder="–í–∞—à –Ω–∏–∫–Ω–µ–π–º" autocomplete="off">
            </div>
            
            <div>
              <div class="label">–ü–∞—Ä–æ–ª—å</div>
              <input id="loginPass" class="input" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password">
            </div>

            <div class="row" style="justify-content:space-between; flex-wrap:wrap;">
              <button id="btnLogin" class="btn btn--roblox"><span class="icon">login</span> –í–æ–π—Ç–∏</button>
              <div id="loginErr" style="color:var(--danger);"></div>
            </div>
            
            <div class="hr"></div>
            
            <div class="auth-switch">
              –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <span id="showRegister">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</span>
            </div>
          </div>
        </div>

        <!-- REGISTER CARD (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
        <div id="registerCard" class="card hidden">
          <div class="card__title">
            <h2><span class="icon" style="color:var(--roblox);">person_add</span> –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <span class="krp-badge"><span class="icon">stadia_controller</span> KRP</span>
          </div>

          <div class="col" style="gap:16px;">
            <div>
              <div class="label">–ò–≥—Ä–æ–≤–æ–π –Ω–∏–∫</div>
              <input id="registerUsername" class="input" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–∏–∫–Ω–µ–π–º" autocomplete="off">
              <div style="font-size:11px; opacity:0.6; margin-top:4px;">–ú–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞, —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ _</div>
            </div>
            
            <div>
              <div class="label">–ü–∞—Ä–æ–ª—å</div>
              <input id="registerPass" class="input" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password">
              <div style="font-size:11px; opacity:0.6; margin-top:4px;">–ú–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞</div>
            </div>

            <div>
              <div class="label">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è</div>
              <input id="registerConfirmPass" class="input" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="new-password">
            </div>

            <div class="row" style="justify-content:space-between; flex-wrap:wrap;">
              <button id="btnRegister" class="btn btn--primary"><span class="icon">person_add</span> –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
              <div id="registerErr" style="color:var(--danger);"></div>
            </div>
            
            <div class="hr"></div>
            
            <div class="auth-switch">
              –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <span id="showLogin">–í–æ–π—Ç–∏</span>
            </div>
          </div>
        </div>

        <!-- LAUNCHER CARD (–æ—Å–Ω–æ–≤–Ω–æ–π) -->
        <div id="launcherCard" class="card hidden">
          <div class="card__title">
            <h2><span class="icon" style="color:var(--roblox);">stadia_controller</span> KRP –õ–∞—É–Ω—á–µ—Ä</h2>
            <span id="playerName" class="badge badge--roblox"><span class="icon">person</span> –ó–∞–≥—Ä—É–∑–∫–∞...</span>
          </div>

          <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∏–≥—Ä–æ–∫–µ -->
          <div class="row" style="gap:16px; margin-bottom:16px; padding:12px; background:var(--surface2); border-radius:var(--r-lg);">
            <div id="playerAvatar" class="avatar-preview">
              <div class="placeholder">?</div>
            </div>
            <div>
              <div style="font-size:18px; font-weight:bold;" id="playerDisplayName">–ò–≥—Ä–æ–∫</div>
              <div class="row" style="gap:8px; margin-top:4px;">
                <span class="badge" id="playerStatus"><span class="icon">check_circle</span> –ê–∫—Ç–∏–≤–µ–Ω</span>
                <span class="badge badge--roblox"><span class="icon">stadia_controller</span> KRP</span>
              </div>
            </div>
          </div>

          <!-- –ë–∞–Ω–Ω–µ—Ä –æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç–∞—Ö -->
          <div style="background:rgba(255,122,122,.1); border:1px solid var(--danger); border-radius:var(--r-lg); padding:12px; margin-bottom:16px;">
            <div class="row" style="gap:8px;">
              <span class="icon" style="color:var(--danger);">warning</span>
              <span style="color:var(--danger); font-weight:bold;">–í–µ–¥—É—Ç—Å—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã</span>
            </div>
            <div style="margin-top:8px; font-size:13px;">
              –°–µ—Ä–≤–µ—Ä KRP BLACK –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü—Ä–∏–Ω–æ—Å–∏–º –∏–∑–≤–∏–Ω–µ–Ω–∏—è –∑–∞ –Ω–µ—É–¥–æ–±—Å—Ç–≤–∞.
            </div>
          </div>

          <h3 style="margin:16px 0 8px;">–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä</h3>
          
          <!-- –°–µ—Ç–∫–∞ –∏–≥—Ä -->
          <div class="game-grid">
            <div class="game-card" data-game="1" id="game1">
              <div class="game-icon">‚ö´</div>
              <div class="game-title">KRP BLACK</div>
              <div class="game-desc">–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏</div>
              <span class="maintenance-badge">–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –†–ê–ë–û–¢–´</span>
            </div>
            
            <div class="game-card" data-game="2" id="game2">
              <div class="game-icon">üîµ</div>
              <div class="game-title">KRP BLUE</div>
              <div class="game-desc">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–≤–µ—Ä —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º</div>
            </div>
          </div>

          <!-- –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã -->
          <div class="launch-section">
            <div class="row" style="justify-content:space-between; margin-bottom:12px;">
              <span><span class="icon">play_circle</span> –ì–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É</span>
              <span id="selectedGameName" style="opacity:0.7;">–ù–µ –≤—ã–±—Ä–∞–Ω–æ</span>
            </div>
            
            <div class="row" style="gap:12px; flex-wrap:wrap;">
              <button id="btnLaunchGame" class="btn btn--game" disabled style="flex:1;">
                <span class="icon">play_arrow</span> –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
              </button>
              <button id="btnCopyLink" class="btn btn--ghost" disabled title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –∏–≥—Ä—É">
                <span class="icon">link</span>
              </button>
            </div>
            
            <div style="margin-top:12px; font-size:12px; opacity:0.6; text-align:center;">
              –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ Roblox
            </div>
          </div>
        </div>

        <!-- NEWS CARD -->
        <div id="newsCard" class="card hidden">
          <div class="card__title">
            <h2><span class="icon" style="color:var(--news);">newspaper</span> –ù–æ–≤–æ—Å—Ç–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</h2>
            <span class="news-badge"><span class="icon">update</span> KRP News</span>
          </div>

          <!-- –§–æ—Ä–º–∞ –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–æ–≤) -->
          <div id="newsFormContainer" class="news-form hidden">
            <div class="label">–ù–æ–≤–∞—è –Ω–æ–≤–æ—Å—Ç—å</div>
            <textarea id="newsText" class="textarea" maxlength="1000" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –Ω–æ–≤–æ—Å—Ç—å –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ..."></textarea>
            <div class="row" style="justify-content:flex-end; margin-top:10px;">
              <button id="btnPostNews" class="btn btn--news"><span class="icon">send</span> –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
            </div>
          </div>

          <!-- –õ–µ–Ω—Ç–∞ –Ω–æ–≤–æ—Å—Ç–µ–π -->
          <div id="newsFeed" class="news-feed">
            <div style="text-align:center; opacity:0.5; padding:20px;">–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π...</div>
          </div>
        </div>

        <!-- PROFILE CARD -->
        <div id="profileCard" class="card hidden">
          <div class="card__title">
            <h2><span class="icon" style="color:var(--roblox);">account_circle</span> –ü—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞</h2>
          </div>

          <div class="col" style="gap:16px;">
            <div class="row" style="gap:20px; flex-wrap:wrap;">
              <div class="avatar-preview" id="profileAvatar" style="width:80px; height:80px;">
                <div class="placeholder">?</div>
              </div>
              <div style="flex:1;">
                <div class="label">–û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è</div>
                <div class="row" style="gap:8px;">
                  <input id="displayName" class="input" placeholder="–í–∞—à–µ –∏–º—è" style="flex:1;">
                  <button id="btnSaveDisplayName" class="btn btn--primary"><span class="icon">save</span></button>
                </div>
              </div>
            </div>

            <div>
              <div class="label">–ò–≥—Ä–æ–≤–æ–π –Ω–∏–∫ (–ª–æ–≥–∏–Ω)</div>
              <div class="row" style="gap:8px;">
                <input id="robloxName" class="input" disabled style="flex:1;">
              </div>
            </div>

            <div class="hr"></div>

            <div>
              <div class="label">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
              <div class="row" style="gap:16px; flex-wrap:wrap;">
                <span class="badge"><span class="icon">play_arrow</span> –ó–∞–ø—É—Å–∫–æ–≤: <b id="launchCount">0</b></span>
                <span class="badge"><span class="icon">schedule</span> –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥: <span id="lastLogin">–Ω–∏–∫–æ–≥–¥–∞</span></span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <aside class="rightcol">
        <div class="card">
          <div class="card__title"><h2>–°—Ç–∞—Ç—É—Å</h2></div>
          <div class="col" style="gap:10px;">
            <div class="row" style="gap:8px;">
              <div id="smallAvatar" class="avatar-preview" style="width:32px; height:32px;">
                <div class="placeholder">?</div>
              </div>
              <span id="statusAuth" class="badge"><span class="icon">key</span> –ì–æ—Å—Ç—å</span>
            </div>
            <span id="onlineStatus" class="badge status-offline"><span class="icon">circle</span> –û—Ñ—Ñ–ª–∞–π–Ω</span>
            <span id="newsCount" class="badge"><span class="icon">newspaper</span> –ù–æ–≤–æ—Å—Ç–µ–π: 0</span>
            <span class="badge badge--maintenance"><span class="icon">construction</span> BLACK: —Ç–µ—Ö—Ä–∞–±–æ—Ç—ã</span>
          </div>
        </div>
        
        <div class="card">
          <div class="card__title"><h2>–ê–≤—Ç–æ—Ä—ã –Ω–æ–≤–æ—Å—Ç–µ–π</h2></div>
          <div style="padding:8px;">
            <div class="badge badge--news" style="margin-bottom:8px;">üìù Doorscelledj</div>
            <div class="badge badge--news">üìù vthdsc_1</div>
          </div>
        </div>
      </aside>
    </main>

    <div id="toast" class="toast">
      <span class="icon" id="toastIcon">info</span>
      <div id="toastMsg"></div>
    </div>
  </div>

  <script>
    // ====== –ó–ê–ì–†–£–ó–û–ß–ù–´–ô –≠–ö–†–ê–ù ======
    window.addEventListener('load', function() {
      setTimeout(function() {
        const loader = document.getElementById('loaderScreen');
        loader.classList.add('fade-out');
        
        // –£–¥–∞–ª—è–µ–º loader –∏–∑ DOM –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
        setTimeout(function() {
          loader.style.display = 'none';
        }, 500);
      }, 2500); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É 2.5 —Å–µ–∫—É–Ω–¥—ã
    });

    // ====== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ======
    const GAMES = {
      1: {
        name: "KRP BLACK",
        url: "https://www.roblox.com/games/133924221012482/Black",
        desc: "–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä KRP",
        icon: "‚ö´",
        color: "black",
        available: false // –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
      },
      2: {
        name: "KRP BLUE",
        url: "https://www.roblox.com/games/106538461230862/Blue",
        desc: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–µ—Ä–≤–µ—Ä KRP",
        icon: "üîµ",
        color: "blue",
        available: true
      }
    };

    const NEWS_AUTHORS = ["doorscelledj", "vthdsc_1"];
    const LS_KEY = "krp_launcher_v1";
    const NEWS_KEY = "krp_news_v1";
    const ENCRYPTION_KEY = "KRPLAUNCHER2024";

    // ====== DOM –≠–õ–ï–ú–ï–ù–¢–´ ======
    const $ = id => document.getElementById(id);
    
    const loginCard = $("loginCard");
    const registerCard = $("registerCard");
    const launcherCard = $("launcherCard");
    const newsCard = $("newsCard");
    const profileCard = $("profileCard");
    
    const navLauncher = $("navLauncher");
    const navNews = $("navNews");
    const navProfile = $("navProfile");
    const btnLogout = $("btnLogout");
    
    const loginUsername = $("loginUsername");
    const loginPass = $("loginPass");
    const btnLogin = $("btnLogin");
    const loginErr = $("loginErr");
    
    const registerUsername = $("registerUsername");
    const registerPass = $("registerPass");
    const registerConfirmPass = $("registerConfirmPass");
    const btnRegister = $("btnRegister");
    const registerErr = $("registerErr");
    
    const showRegister = $("showRegister");
    const showLogin = $("showLogin");
    
    const playerName = $("playerName");
    const playerDisplayName = $("playerDisplayName");
    const playerAvatar = $("playerAvatar");
    const smallAvatar = $("smallAvatar");
    const playerStatus = $("playerStatus");
    
    const game1 = $("game1");
    const game2 = $("game2");
    const selectedGameName = $("selectedGameName");
    const btnLaunchGame = $("btnLaunchGame");
    const btnCopyLink = $("btnCopyLink");
    
    const profileAvatar = $("profileAvatar");
    const displayNameInput = $("displayName");
    const robloxName = $("robloxName");
    const btnSaveDisplayName = $("btnSaveDisplayName");
    const launchCount = $("launchCount");
    const lastLogin = $("lastLogin");
    
    const statusAuth = $("statusAuth");
    const onlineStatus = $("onlineStatus");
    const newsCount = $("newsCount");
    
    const newsFormContainer = $("newsFormContainer");
    const newsText = $("newsText");
    const btnPostNews = $("btnPostNews");
    const newsFeed = $("newsFeed");
    
    const toastEl = $("toast");
    const toastIcon = $("toastIcon");
    const toastMsg = $("toastMsg");

    // ====== –°–û–°–¢–û–Ø–ù–ò–ï ======
    let sessionUser = null;
    let selectedGame = null;
    let toastTimer = null;
    let news = [];

    // ====== –£–¢–ò–õ–ò–¢–´ ======
    function toast(message, icon = "info", ms = 2400) {
      toastIcon.textContent = icon;
      toastMsg.innerHTML = message;
      toastEl.classList.add("show");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => toastEl.classList.remove("show"), ms);
    }

    function escapeHtml(s) {
      return String(s)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    async function sha256Hash(text) {
      if (!text) return text;
      const encoder = new TextEncoder();
      const data = encoder.encode(text + ENCRYPTION_KEY);
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
      return hashHex;
    }

    function normalizeUsername(u) {
      return u.trim().toLowerCase().replace(/[^a-z0-9_]/g, "");
    }

    function formatDateTime(ms) {
      if (!ms) return "–Ω–∏–∫–æ–≥–¥–∞";
      const d = new Date(ms);
      const now = new Date();
      const diff = Math.floor((now - d) / 1000);
      
      if (diff < 60) return "—Ç–æ–ª—å–∫–æ —á—Ç–æ";
      if (diff < 3600) return `${Math.floor(diff / 60)} –º–∏–Ω –Ω–∞–∑–∞–¥`;
      if (diff < 86400) return `${Math.floor(diff / 3600)} —á –Ω–∞–∑–∞–¥`;
      return d.toLocaleDateString() + " " + d.toLocaleTimeString().slice(0,5);
    }

    function canPostNews(username) {
      return username && NEWS_AUTHORS.includes(username.toLowerCase());
    }

    // ====== –ù–û–í–û–°–¢–ò ======
    function loadNews() {
      const saved = localStorage.getItem(NEWS_KEY);
      if (saved) {
        try {
          news = JSON.parse(saved);
        } catch {
          news = [];
        }
      } else {
        // –ù–æ–≤–æ—Å—Ç–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        news = [
          {
            id: "1",
            author: "Doorscelledj",
            content: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ KRP Launcher! –ó–¥–µ—Å—å –±—É–¥—É—Ç –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å—Å—è –Ω–æ–≤–æ—Å—Ç–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤.",
            time: Date.now() - 86400000
          },
          {
            id: "2",
            author: "vthdsc_1",
            content: "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ! –°–µ—Ä–≤–µ—Ä KRP BLACK –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –ø—Ä–∏—á–∏–Ω–∞–º. –í–µ–¥—É—Ç—Å—è —Ä–∞–±–æ—Ç—ã –ø–æ —É–ª—É—á—à–µ–Ω–∏—é.",
            time: Date.now() - 43200000
          }
        ];
        saveNews();
      }
      renderNews();
    }

    function saveNews() {
      localStorage.setItem(NEWS_KEY, JSON.stringify(news));
    }

    function renderNews() {
      if (news.length === 0) {
        newsFeed.innerHTML = '<div style="text-align:center; opacity:0.5; padding:20px;">–ù–æ–≤–æ—Å—Ç–µ–π –ø–æ–∫–∞ –Ω–µ—Ç</div>';
        newsCount.innerHTML = '<span class="icon">newspaper</span> –ù–æ–≤–æ—Å—Ç–µ–π: 0';
        return;
      }

      // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (—Å–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ)
      const sorted = [...news].sort((a, b) => b.time - a.time);
      
      newsFeed.innerHTML = '';
      for (const item of sorted) {
        const el = document.createElement('div');
        el.className = 'news-item';
        el.dataset.id = item.id;
        
        const canDelete = sessionUser && 
          (sessionUser.username.toLowerCase() === item.author.toLowerCase() || 
           NEWS_AUTHORS.includes(sessionUser.username.toLowerCase()));
        
        el.innerHTML = `
          <div class="news-header">
            <span class="news-author">${escapeHtml(item.author)}</span>
            <span class="news-time">${formatDateTime(item.time)}</span>
            ${canDelete ? '<span class="delete-news material-symbols-rounded" title="–£–¥–∞–ª–∏—Ç—å">delete</span>' : ''}
          </div>
          <div class="news-content">${escapeHtml(item.content)}</div>
        `;
        
        if (canDelete) {
          const deleteBtn = el.querySelector('.delete-news');
          deleteBtn.addEventListener('click', () => deleteNews(item.id));
        }
        
        newsFeed.appendChild(el);
      }
      
      newsCount.innerHTML = `<span class="icon">newspaper</span> –ù–æ–≤–æ—Å—Ç–µ–π: ${news.length}`;
    }

    function deleteNews(id) {
      if (!sessionUser) return;
      
      const newsItem = news.find(n => n.id === id);
      if (!newsItem) return;
      
      if (sessionUser.username.toLowerCase() !== newsItem.author.toLowerCase() && 
          !NEWS_AUTHORS.includes(sessionUser.username.toLowerCase())) {
        toast("–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —ç—Ç–æ–π –Ω–æ–≤–æ—Å—Ç–∏", "error");
        return;
      }
      
      if (!confirm("–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –Ω–æ–≤–æ—Å—Ç—å?")) return;
      
      news = news.filter(n => n.id !== id);
      saveNews();
      renderNews();
      toast("–ù–æ–≤–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∞", "delete");
    }

    btnPostNews.addEventListener("click", () => {
      if (!sessionUser) {
        toast("–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É", "warning");
        return;
      }
      
      if (!canPostNews(sessionUser.username)) {
        toast("–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏—é –Ω–æ–≤–æ—Å—Ç–µ–π", "error");
        return;
      }
      
      const content = newsText.value.trim();
      if (!content) {
        toast("–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏", "warning");
        return;
      }
      
      if (content.length > 1000) {
        toast("–ú–∞–∫—Å–∏–º—É–º 1000 —Å–∏–º–≤–æ–ª–æ–≤", "warning");
        return;
      }
      
      const newNews = {
        id: Date.now().toString(),
        author: sessionUser.username,
        content: content,
        time: Date.now()
      };
      
      news.unshift(newNews);
      saveNews();
      renderNews();
      newsText.value = "";
      toast("–ù–æ–≤–æ—Å—Ç—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞", "check_circle");
    });

    // ====== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –ú–ï–ñ–î–£ –í–•–û–î–û–ú –ò –†–ï–ì–ò–°–¢–†–ê–¶–ò–ï–ô ======
    showRegister.addEventListener("click", () => {
      loginCard.classList.add("hidden");
      registerCard.classList.remove("hidden");
      clearAuthErrors();
    });

    showLogin.addEventListener("click", () => {
      registerCard.classList.add("hidden");
      loginCard.classList.remove("hidden");
      clearAuthErrors();
    });

    function clearAuthErrors() {
      loginErr.textContent = "";
      registerErr.textContent = "";
    }

    // ====== –°–ï–°–°–ò–Ø ======
    function saveSession(user) {
      localStorage.setItem(LS_KEY, JSON.stringify(user));
      sessionUser = user;
      refreshUI();
    }

    function clearSession() {
      localStorage.removeItem(LS_KEY);
      sessionUser = null;
      selectedGame = null;
      refreshUI();
    }

    function loadSession() {
      try {
        const raw = localStorage.getItem(LS_KEY);
        if (!raw) return null;
        return JSON.parse(raw);
      } catch {
        return null;
      }
    }

    // ====== –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò ======
    btnRegister.addEventListener("click", async () => {
      const username = normalizeUsername(registerUsername.value);
      const pass = registerPass.value;
      const confirmPass = registerConfirmPass.value;
      
      if (username.length < 3) {
        registerErr.textContent = "–ú–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞";
        return;
      }
      
      if (pass.length < 4) {
        registerErr.textContent = "–ü–∞—Ä–æ–ª—å –º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞";
        return;
      }
      
      if (pass !== confirmPass) {
        registerErr.textContent = "–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç";
        return;
      }
      
      try {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–Ω—è—Ç –ª–∏ –Ω–∏–∫
        const existing = localStorage.getItem(`krp_user_${username}`);
        if (existing) {
          registerErr.textContent = "–≠—Ç–æ—Ç –Ω–∏–∫ —É–∂–µ –∑–∞–Ω—è—Ç";
          return;
        }
        
        const userData = {
          username,
          displayName: username,
          avatar: null,
          passHash: await sha256Hash(pass),
          createdAt: Date.now(),
          lastLogin: Date.now(),
          launchHistory: [],
          launchCount: 0
        };
        
        localStorage.setItem(`krp_user_${username}`, JSON.stringify(userData));
        
        saveSession({
          username,
          displayName: username,
          avatar: null,
          launchCount: 0,
          launchHistory: []
        });
        
        toast("–ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ KRP", "check_circle");
        registerErr.textContent = "";
      } catch (e) {
        registerErr.textContent = "–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏";
        toast("–û—à–∏–±–∫–∞: " + e.message, "error");
      }
    });

    btnLogin.addEventListener("click", async () => {
      const username = normalizeUsername(loginUsername.value);
      const pass = loginPass.value;
      
      if (username.length < 3) {
        loginErr.textContent = "–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º";
        return;
      }
      
      if (!pass) {
        loginErr.textContent = "–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å";
        return;
      }
      
      try {
        const saved = localStorage.getItem(`krp_user_${username}`);
        if (!saved) {
          loginErr.textContent = "–ê–∫–∫–∞—É–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å.";
          return;
        }
        
        const userData = JSON.parse(saved);
        const passHash = await sha256Hash(pass);
        
        if (passHash !== userData.passHash) {
          loginErr.textContent = "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å";
          return;
        }
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –≤—Ö–æ–¥–∞
        userData.lastLogin = Date.now();
        localStorage.setItem(`krp_user_${username}`, JSON.stringify(userData));
        
        saveSession({
          username,
          displayName: userData.displayName || username,
          avatar: userData.avatar,
          launchCount: userData.launchCount || 0,
          launchHistory: userData.launchHistory || []
        });
        
        toast("–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω. –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã –Ω–∞ KRP!", "login");
        loginErr.textContent = "";
      } catch (e) {
        loginErr.textContent = "–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞";
        toast("–û—à–∏–±–∫–∞: " + e.message, "error");
      }
    });

    btnLogout.addEventListener("click", clearSession);

    // –ù–∞–≤–∏–≥–∞—Ü–∏—è
    navLauncher.addEventListener("click", () => {
      showOnly("launcher");
    });
    
    navNews.addEventListener("click", () => {
      showOnly("news");
    });
    
    navProfile.addEventListener("click", () => {
      showOnly("profile");
      loadProfile();
    });

    function showOnly(which) {
      if (!sessionUser) {
        // –ï—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –æ–∫–Ω–∞ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        return;
      }
      
      launcherCard.classList.toggle("hidden", which !== "launcher");
      newsCard.classList.toggle("hidden", which !== "news");
      profileCard.classList.toggle("hidden", which !== "profile");
      
      if (which === "news") {
        renderNews();
      }
    }

    // –í—ã–±–æ—Ä –∏–≥—Ä—ã - –¢–û–õ–¨–ö–û BLUE –¥–æ—Å—Ç—É–ø–µ–Ω
    game1.addEventListener("click", (e) => {
      e.preventDefault();
      toast("KRP BLACK –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –í–µ–¥—É—Ç—Å—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã.", "warning");
    });
    
    game2.addEventListener("click", () => {
      if (!sessionUser) return;
      selectGame(2); // –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ BLUE
    });

    function selectGame(gameId) {
      if (gameId === 1) {
        toast("KRP BLACK –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω", "warning");
        return;
      }
      
      selectedGame = gameId;
      game2.classList.toggle("selected", gameId === 2);
      selectedGameName.textContent = GAMES[gameId].name;
      btnLaunchGame.disabled = false;
      btnCopyLink.disabled = false;
    }

    // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
    btnLaunchGame.addEventListener("click", () => {
      if (!selectedGame || !sessionUser) return;
      
      const game = GAMES[selectedGame];
      
      if (!game.available) {
        toast("–≠—Ç–æ—Ç —Å–µ—Ä–≤–µ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω", "warning");
        return;
      }
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
      const launchRecord = {
        gameId: selectedGame,
        gameName: game.name,
        timestamp: Date.now()
      };
      
      sessionUser.launchHistory = sessionUser.launchHistory || [];
      sessionUser.launchHistory.unshift(launchRecord);
      if (sessionUser.launchHistory.length > 10) sessionUser.launchHistory.pop();
      
      sessionUser.launchCount = (sessionUser.launchCount || 0) + 1;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage
      const saved = localStorage.getItem(`krp_user_${sessionUser.username}`);
      if (saved) {
        const userData = JSON.parse(saved);
        userData.launchHistory = sessionUser.launchHistory;
        userData.launchCount = sessionUser.launchCount;
        localStorage.setItem(`krp_user_${sessionUser.username}`, JSON.stringify(userData));
      }
      
      saveSession(sessionUser);
      
      // –û—Ç–∫—Ä—ã–≤–∞–µ–º –∏–≥—Ä—É –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ
      window.open(game.url, "_blank");
      toast(`–ó–∞–ø—É—Å–∫ ${game.name}...`, "play_arrow");
    });

    btnCopyLink.addEventListener("click", () => {
      if (!selectedGame) return;
      const game = GAMES[selectedGame];
      if (!game.available) {
        toast("–≠—Ç–æ—Ç —Å–µ—Ä–≤–µ—Ä –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω", "warning");
        return;
      }
      navigator.clipboard.writeText(GAMES[selectedGame].url);
      toast("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!", "link");
    });

    // –ü—Ä–æ—Ñ–∏–ª—å
    btnSaveDisplayName.addEventListener("click", () => {
      if (!sessionUser) return;
      const newName = displayNameInput.value.trim();
      if (!newName) return toast("–í–≤–µ–¥–∏—Ç–µ –∏–º—è", "warning");
      
      sessionUser.displayName = newName;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –≤ localStorage
      const saved = localStorage.getItem(`krp_user_${sessionUser.username}`);
      if (saved) {
        const userData = JSON.parse(saved);
        userData.displayName = newName;
        localStorage.setItem(`krp_user_${sessionUser.username}`, JSON.stringify(userData));
      }
      
      saveSession(sessionUser);
      toast("–ò–º—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ", "check_circle");
    });

    function loadProfile() {
      if (!sessionUser) return;
      displayNameInput.value = sessionUser.displayName || sessionUser.username;
      robloxName.value = sessionUser.username;
      launchCount.textContent = sessionUser.launchCount || 0;
      lastLogin.textContent = formatDateTime(sessionUser.lastLogin);
      
      const initial = (sessionUser.displayName || sessionUser.username)[0];
      profileAvatar.innerHTML = `<div class="placeholder">${initial}</div>`;
    }

    function refreshUI() {
      if (!sessionUser) {
        statusAuth.innerHTML = `<span class="icon">key</span> –ì–æ—Å—Ç—å`;
        onlineStatus.className = "badge status-offline";
        onlineStatus.innerHTML = '<span class="icon">circle</span> –û—Ñ—Ñ–ª–∞–π–Ω';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ –≤—Ö–æ–¥–∞, —Å–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ
        loginCard.classList.remove("hidden");
        registerCard.classList.add("hidden");
        launcherCard.classList.add("hidden");
        newsCard.classList.add("hidden");
        profileCard.classList.add("hidden");
        
        btnLogout.classList.add("hidden");
        navProfile.classList.add("hidden");
        return;
      }
      
      btnLogout.classList.remove("hidden");
      navProfile.classList.remove("hidden");
      
      // –°–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–∞ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
      loginCard.classList.add("hidden");
      registerCard.classList.add("hidden");
      
      statusAuth.innerHTML = `<span class="icon">verified_user</span> <b>${escapeHtml(sessionUser.displayName || sessionUser.username)}</b>`;
      onlineStatus.className = "badge status-online";
      onlineStatus.innerHTML = '<span class="icon">circle</span> –û–Ω–ª–∞–π–Ω';
      
      playerName.innerHTML = `<span class="icon">person</span> ${escapeHtml(sessionUser.displayName || sessionUser.username)}`;
      playerDisplayName.textContent = sessionUser.displayName || sessionUser.username;
      
      // –ê–≤–∞—Ç–∞—Ä–∫–∏
      const initial = (sessionUser.displayName || sessionUser.username)[0];
      playerAvatar.innerHTML = `<div class="placeholder">${initial}</div>`;
      smallAvatar.innerHTML = `<div class="placeholder">${initial}</div>`;
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –Ω–æ–≤–æ—Å—Ç–µ–π –µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∞–≤–∞
      if (canPostNews(sessionUser.username)) {
        newsFormContainer.classList.remove("hidden");
      } else {
        newsFormContainer.classList.add("hidden");
      }
      
      // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω–æ–≤–æ—Å—Ç–µ–π
      newsCount.innerHTML = `<span class="icon">newspaper</span> –ù–æ–≤–æ—Å—Ç–µ–π: ${news.length}`;
      
      showOnly("launcher");
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    const savedSession = loadSession();
    if (savedSession) {
      sessionUser = savedSession;
    }
    
    loadNews();
    refreshUI();
  </script>
</body>
</html>
